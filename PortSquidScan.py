#!/usr/bin/python
import requests
import sys
import signal
import time

# Colores
greenColour = "\033[0;32m\033[1m"
endColour = "\033[0m\033[0m"
redColour = "\033[0;31m\033[1m"
blueColour = "\033[0;34m\033[1m"
yellowColour = "\033[0;33m\033[1m"
purpleColour = "\033[0;35m\033[1m"
turquoiseColour = "\033[0;36m\033[1m"
grayColour = "\033[0;37m\033[1m"
orangeColour = "\033[0;33m\033[1m"

def saliendo(sig, frame):
        print('\n\n[+] Saliendo...\n\n')
        sys.exit(1)


# Capturar control C
signal.signal(signal.SIGINT, saliendo) # cuando hagamos ctrl_c mandamos el flujo del progama a la funcion saliendo

# Variables para valores predeterminados
default_proxy_port = "3128"



# Imprimir el arte en la posición actual
print("▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄")
print("██░▄▄░█▀▄▄▀█░▄▄▀█▄░▄██░▄▄▄░█░▄▄░█░██░██▄██░▄▀██░▄▄▄░█▀▄▀█░▄▄▀█░▄▄▀")
print("██░▀▀░█░██░█░▀▀▄██░███▄▄▄▀▀█░▀▀░█░██░██░▄█░█░██▄▄▄▀▀█░█▀█░▀▀░█░██░")
print("██░█████▄▄██▄█▄▄██▄███░▀▀▀░████░██▄▄▄█▄▄▄█▄▄███░▀▀▀░██▄██▄██▄█▄██▄")
print("▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀")
print("By B3XAL ")
print(" ")
time.sleep(1)

# Solicitar la dirección IP al usuario
ip = input("\n" + blueColour + "Ingresa la dirección IP a escanear:  " + endColour)

# Solicitar el puerto del proxy al usuario, la dirección a escanear se asumirá que será también la IP del proxy.
proxyport = input(f"\n{blueColour}Ingresa el puerto del proxy (Predeterminado: {default_proxy_port}): {endColour}") or default_proxy_port


# Define conjuntos de puertos
puertos_tcp_50 = {
    "21", "22", "23", "25", "53", "80", "110", "111", "135", "139",
    "143", "443", "445", "993", "995", "1723", "3306", "3389", "5900",
    "8080", "8888", "1025", "1433", "1720", "2000", "5000", "5432",
    "8000", "8008", "8009", "8081", "8082", "8083", "8084", "8085",
    "8086", "8087", "8088", "8089", "8090", "8091", "8092", "8093",
    "8094", "8095", "8096", "8097", "8098", "8099", "8100", "8101"
}


puertos_tcp_100 = {
    "21", "22", "23", "25", "53", "80", "110", "111", "135", "139",
    "143", "443", "445", "993", "995", "1723", "3306", "3389", "5900",
    "8080", "8888", "1025", "1433", "1720", "2000", "5000", "5432",
    "8000", "8008", "8009", "8081", "8082", "8083", "8084", "8085",
    "8086", "8087", "8088", "8089", "8090", "8091", "8092", "8093",
    "8094", "8095", "8096", "8097", "8098", "8099", "8100", "8101",
    "2222", "3128", "3300", "4444", "5555", "6666", "7777", "8888",
    "9999", "10000", "32768", "32769", "32770", "32771", "32772",
    "32773", "32774", "32775", "32776", "32777", "32778", "32779",
    "32780", "32781", "32782", "32783", "32784", "32785", "32786",
    "32787", "32788", "32789", "32790", "32791", "32792", "32793",
    "32794", "32795", "32796", "32797", "32798", "32799", "32800",
    "32801", "32802", "32803", "32804", "32805", "32806", "32807",
    "32808", "32809", "32810", "32811", "32812", "32813", "32814",
    "32815", "32816", "32817", "32818", "32819", "32820", "32821",
    "32822", "32823", "32824", "32825", "32826", "32827", "32828",
    "32829", "32830", "32831", "32832", "32833", "32834", "32835",
    "32836", "32837", "32838", "32839", "32840", "32841", "32842",
    "32843", "32844", "32845", "32846", "32847", "32848", "32849",
    "32850", "32851", "32852", "32853", "32854", "32855", "32856",
    "32857", "32858", "32859", "32860", "32861", "32862", "32863",
    "32864", "32865", "32866", "32867", "32868", "32869", "32870",
    "32871", "32872", "32873", "32874", "32875", "32876", "32877",
    "32878", "32879", "32880", "32881", "32882", "32883", "32884",
    "32885", "32886", "32887", "32888", "32889", "32890", "32891",
    "32892", "32893", "32894", "32895", "32896", "32897", "32898",
    "32899", "32900", "32901", "32902", "32903", "32904", "32905",
    "32906", "32907", "32908", "32909", "32910", "32911", "32912",
    "32913", "32914", "32915", "32916", "32917", "32918", "32919",
    "32920", "32921", "32922", "32923", "32924", "32925", "32926",
    "32927", "32928", "32929", "32930", "32931", "32932", "32933",
    "32934", "32935", "32936", "32937", "32938", "32939", "32940",
    "32941", "32942", "32943", "32944", "32945", "32946", "32947",
    "32948", "32949", "32950", "32951", "32952", "32953", "32954",
    "32955", "32956", "32957", "32958", "32959", "32960", "32961",
    "32962", "32963", "32964", "32965", "32966", "32967", "32968",
    "32969", "32970", "32971", "32972", "32973", "32974", "32975",
    "32976", "32977", "32978", "32979", "32980", "32981", "32982",
    "32983", "32984", "32985", "32986", "32987", "32988", "32989",
    "32990", "32991", "32992", "32993", "32994", "32995", "32996",
    "32997", "32998", "32999", "33001", "33002", "33003", "33004",
    "33005", "33006", "33007", "33008", "33009", "33010", "33011",
    "33012", "33013", "33014", "33015", "33016", "33017", "33018",
    "33019", "33020", "33021", "33022", "33023", "33024", "33025",
    "33026", "33027", "33028", "33029", "33030", "33031", "33032",
    "33033", "33034", "33035", "33036", "33037", "33038", "33039",
    "33040", "33041", "33042", "33043", "33044", "33045", "33046",
    "33047", "33048", "33049", "33050"
}


puertos_tcp_500 = {
    "21", "22", "23", "25", "53", "80", "110", "111", "135", "139",
    "143", "443", "445", "993", "995", "1723", "3306", "3389", "5900",
    "8080", "8888", "1025", "1433", "1720", "2000", "5000", "5432",
    "8000", "8008", "8009", "8081", "8082", "8083", "8084", "8085",
    "8086", "8087", "8088", "8089", "8090", "8091", "8092", "8093",
    "8094", "8095", "8096", "8097", "8098", "8099", "8100", "8101",
    "2222", "3128", "3300", "4444", "5555", "6666", "7777", "8888",
    "9999", "10000", "32768", "32769", "32770", "32771", "32772",
    "32773", "32774", "32775", "32776", "32777", "32778", "32779",
    "32780", "32781", "32782", "32783", "32784", "32785", "32786",
    "32787", "32788", "32789", "32790", "32791", "32792", "32793",
    "32794", "32795", "32796", "32797", "32798", "32799", "32800",
    "32801", "32802", "32803", "32804", "32805", "32806", "32807",
    "32808", "32809", "32810", "32811", "32812", "32813", "32814",
    "32815", "32816", "32817", "32818", "32819", "32820", "32821",
    "32822", "32823", "32824", "32825", "32826", "32827", "32828",
    "32829", "32830", "32831", "32832", "32833", "32834", "32835",
    "32836", "32837", "32838", "32839", "32840", "32841", "32842",
    "32843", "32844", "32845", "32846", "32847", "32848", "32849",
    "32850", "32851", "32852", "32853", "32854", "32855", "32856",
    "32857", "32858", "32859", "32860", "32861", "32862", "32863",
    "32864", "32865", "32866", "32867", "32868", "32869", "32870",
    "32871", "32872", "32873", "32874", "32875", "32876", "32877",
    "32878", "32879", "32880", "32881", "32882", "32883", "32884",
    "32885", "32886", "32887", "32888", "32889", "32890", "32891",
    "32892", "32893", "32894", "32895", "32896", "32897", "32898",
    "32899", "32900", "32901", "32902", "32903", "32904", "32905",
    "32906", "32907", "32908", "32909", "32910", "32911", "32912",
    "32913", "32914", "32915", "32916", "32917", "32918", "32919",
    "32920", "32921", "32922", "32923", "32924", "32925", "32926",
    "32927", "32928", "32929", "32930", "32931", "32932", "32933",
    "32934", "32935", "32936", "32937", "32938", "32939", "32940",
    "32941", "32942", "32943", "32944", "32945", "32946", "32947",
    "32948", "32949", "32950", "32951", "32952", "32953", "32954",
    "32955", "32956", "32957", "32958", "32959", "32960", "32961",
    "32962", "32963", "32964", "32965", "32966", "32967", "32968",
    "32969", "32970", "32971", "32972", "32973", "32974", "32975",
    "32976", "32977", "32978", "32979", "32980", "32981", "32982",
    "32983", "32984", "32985", "32986", "32987", "32988", "32989",
    "32990", "32991", "32992", "32993", "32994", "32995", "32996",
    "32997", "32998", "32999", "33001", "33002", "33003", "33004",
    "33005", "33006", "33007", "33008", "33009", "33010", "33011",
    "33012", "33013", "33014", "33015", "33016", "33017", "33018",
    "33019", "33020", "33021", "33022", "33023", "33024", "33025",
    "33026", "33027", "33028", "33029", "33030", "33031", "33032",
    "33033", "33034", "33035", "33036", "33037", "33038", "33039",
    "33040", "33041", "33042", "33043", "33044", "33045", "33046",
    "33047", "33048", "33049", "33050", "33051", "33052", "33053",
    "33054", "33055", "33056", "33057", "33058", "33059", "33060",
    "33061", "33062", "33063", "33064", "33065", "33066", "33067",
    "33068", "33069", "33070", "33071", "33072", "33073", "33074",
    "33075", "33076", "33077", "33078", "33079", "33080", "33081",
    "33082", "33083", "33084", "33085", "33086", "33087", "33088",
    "33089", "33090", "33091", "33092", "33093", "33094", "33095",
    "33096", "33097", "33098", "33099", "33100", "33101", "33102",
    "33103", "33104", "33105", "33106", "33107", "33108", "33109",
    "33110", "33111", "33112", "33113", "33114", "33115", "33116",
    "33117", "33118", "33119", "33120", "33121", "33122", "33123",
    "33124", "33125", "33126", "33127", "33128", "33129", "33130",
    "33131", "33132", "33133", "33134", "33135", "33136", "33137",
    "33138", "33139", "33140", "33141", "33142", "33143", "33144",
    "33145", "33146", "33147", "33148", "33149", "33150", "33151",
    "33152", "33153", "33154", "33155", "33156", "33157", "33158",
    "33159", "33160", "33161", "33162", "33163", "33164", "33165",
    "33166", "33167", "33168", "33169", "33170", "33171", "33172",
    "33173", "33174", "33175", "33176", "33177", "33178", "33179",
    "33180", "33181", "33182", "33183", "33184", "33185", "33186",
    "33187", "33188", "33189", "33190", "33191", "33192", "33193",
    "33194", "33195", "33196", "33197", "33198", "33199", "33200",
    "33201", "33202", "33203", "33204", "33205", "33206", "33207",
    "33208", "33209", "33210", "33211", "33212", "33213", "33214",
    "33215", "33216", "33217", "33218", "33219", "33220", "33221",
    "33222", "33223", "33224", "33225", "33226", "33227", "33228",
    "33229", "33230", "33231", "33232", "33233", "33234", "33235",
    "33236", "33237", "33238", "33239", "33240", "33241", "33242",
    "33243", "33244", "33245", "33246", "33247", "33248", "33249",
    "33250"
}


puertos_tcp_1000 = {
    "1", "3", "6", "7", "9", "13", "17", "19", "20", "21",
    "22", "23", "24", "25", "26", "30", "32", "33", "37", "42",
    "43", "49", "53", "70", "79", "80", "81", "82", "83", "84",
    "85", "88", "89", "90", "99", "100", "106", "109", "110",
    "111", "113", "119", "125", "135", "139", "143", "144", "146",
    "161", "163", "179", "199", "211", "212", "222", "254", "255",
    "256", "259", "264", "280", "301", "306", "311", "340", "366",
    "389", "406", "407", "416", "417", "425", "427", "443", "444",
    "445", "458", "464", "465", "481", "497", "500", "512", "513",
    "514", "515", "524", "541", "543", "544", "545", "548", "554",
    "555", "563", "587", "593", "616", "617", "625", "631", "636",
    "646", "648", "666", "667", "668", "683", "687", "691", "700",
    "705", "711", "714", "720", "722", "726", "749", "765", "777",
    "783", "787", "800", "808", "843", "873", "888", "898", "901",
    "902", "911", "993", "995", "999", "1000", "1001", "1002",
    "1007", "1009", "1010", "1011", "1021", "1100", "1102", "1104",
    "1105", "1122", "1126", "1130", "1131", "1155", "1164", "1194",
    "1200", "1214", "1241", "1296", "1300", "1313", "1321", "1337",
    "1352", "1380", "1389", "1394", "1397", "1433", "1434", "1443",
    "1455", "1494", "1500", "1501", "1503", "1521", "1524", "1533",
    "1556", "1580", "1583", "1594", "1600", "1641", "1658", "1666",
    "1687", "1700", "1717", "1718", "1719", "1720", "1723", "1755",
    "1761", "1782", "1801", "1812", "1839", "1862", "1863", "1875",
    "1900", "1914", "1935", "1947", "1971", "1984", "1998", "2000",
    "2001", "2003", "2005", "2006", "2008", "2010", "2013", "2020",
    "2021", "2022", "2030", "2033", "2034", "2035", "2038", "2040",
    "2041", "2042", "2043", "2045", "2046", "2047", "2048", "2049",
    "2065", "2068", "2099", "2100", "2103", "2105", "2106", "2107",
    "2111", "2119", "2120", "2121", "2126", "2135", "2144", "2160",
    "2161", "2166", "2170", "2179", "2190", "2191", "2196", "2200",
    "2222", "2251", "2260", "2288", "2301", "2323", "2366", "2381",
    "2393", "2394", "2399", "2401", "2492", "2500", "2522", "2525",
    "2557", "2601", "2602", "2604", "2605", "2607", "2608", "2638",
    "2701", "2702", "2710", "2717", "2718", "2725", "2800", "2809",
    "2811", "2869", "2875", "2909", "2910", "2920", "2967", "2968",
    "2998", "3000", "3001", "3003", "3005", "3006", "3007", "3011",
    "3013", "3017", "3030", "3031", "3052", "3071", "3077", "3128",
    "3168", "3211", "3221", "3260", "3268", "3269", "3283", "3300",
    "3306", "3320", "3322", "3323", "3325", "3333", "3351", "3352",
    "3367", "3369", "3370", "3371", "3372", "3386", "3389", "3390",
    "3404", "3476", "3493", "3517", "3527", "3546", "3551", "3580",
    "3659", "3689", "3690", "3703", "3737", "3766", "3784", "3800",
    "3801", "3809", "3814", "3826", "3827", "3851", "3869", "3871",
    "3878", "3880", "3889", "3905", "3914", "3918", "3920", "3945",
    "3971", "3986", "3995", "3998", "4000", "4001", "4002", "4003",
    "4004", "4005", "4006", "4040", "4045", "4111", "4125", "4126",
    "4129", "4224", "4242", "4279", "4321", "4343", "4443", "4444",
    "4445", "4446", "4447", "4448", "4449", "4550", "4567", "4662",
    "4664", "4672", "4899", "4900", "4998", "5000", "5001", "5002",
    "5003", "5009", "5050", "5051", "5052", "5055", "5056", "5060",
    "5061", "5093", "5145", "5150", "5190", "5222", "5225", "5226",
    "5269", "5280", "5298", "5357", "5400", "5402", "5405", "5432",
    "5440", "5450", "5500", "5510", "5544", "5550", "5555", "5560",
    "5566", "5631", "5633", "5666", "5678", "5679", "5718", "5730",
    "5800", "5801", "5802", "5805", "5900", "5901", "5902", "5903",
    "5904", "5906", "5907", "5910", "5911", "5915", "5922", "5925",
    "5950", "5952", "5959", "5960", "5961", "5962", "5963", "5987",
    "5988", "5989", "5998", "5999", "6000", "6001", "6002", "6003",
    "6004", "6005", "6006", "6007", "6009", "6025", "6059", "6100",
    "6101", "6106", "6110", "6111", "6112", "6123", "6129", "6156",
    "6346", "6389", "6502", "6510", "6543", "6547", "6565", "6566",
    "6660", "6661", "6662", "6663", "6664", "6665", "6666", "6667",
    "6668", "6669", "6670", "6672", "6673", "6689", "6692", "6699",
    "6779", "6788", "6789", "6792", "6839", "6881", "6901", "6969",
    "7000", "7001", "7002", "7004", "7007", "7019", "7025", "7070",
    "7100", "7103", "7106", "7200", "7402", "7435", "7443", "7496",
    "7512", "7625", "7627", "7676", "7741", "7770", "7777", "7778",
    "7800", "7911", "7920", "7921", "7937", "7938", "7999", "8000",
    "8001", "8002", "8003", "8004", "8005", "8006", "8007", "8008",
    "8009", "8010", "8011", "8021", "8022", "8031", "8042", "8045",
    "8080", "8081", "8082", "8083", "8084", "8085", "8086", "8087",
    "8088", "8089", "8090", "8091", "8092", "8093", "8094", "8095",
    "8096", "8097", "8098", "8099", "8100", "8101", "8102", "8118",
    "8121", "8123", "8180", "8181", "8192", "8193", "8194", "8200",
    "8222", "8254", "8290", "8291", "8292", "8300", "8333", "8383",
    "8400", "8402", "8443", "8500", "8600", "8649", "8651", "8652",
    "8654", "8701", "8800", "8873", "8888", "8899", "8994", "9000",
    "9001", "9002", "9003", "9009", "9010", "9011", "9040", "9050",
    "9071", "9080", "9081", "9090", "9091", "9099", "9100", "9101",
    "9102", "9103", "9110", "9111", "9200", "9207", "9220", "9290",
    "9415", "9418", "9485", "9500", "9502", "9503", "9535", "9575",
    "9593", "9594", "9595", "9618", "9666", "9876", "9877", "9878",
    "9898", "9900", "9917", "9929", "9943", "9944", "9968", "9998",
    "9999", "10000", "10001", "10002", "10003", "10004", "10009",
    "10010", "10012", "10024", "10025", "10082", "10180", "10215",
    "10243", "10566", "10616", "10617", "10621", "10626", "10628",
    "10629", "10778", "11110", "11111", "11967", "12000", "12174",
    "12265", "12345", "13456", "13722", "13782", "13783", "14000",
    "14238", "14441", "14442", "15000", "15002", "15003", "15004",
    "15660", "15742", "16000", "16001", "16012", "16016", "16018",
    "16080", "16113", "16992", "16993", "17877", "17988", "18040",
    "18101", "18988", "19101", "19283", "19315", "19350", "19780",
    "19801", "19842", "20000", "20005", "20031", "20221", "20222",
    "20828", "21571", "22939", "23502", "24444", "24800", "25734",
    "25735", "26214", "27000", "27352", "27353", "27355", "27356",
    "27715", "28201", "30000", "30718", "30951", "31038", "31337",
    "32768", "32769", "32770", "32771", "32772", "32773", "32774",
    "32775", "32776", "32777", "32778", "32779", "32780", "32781",
    "32782", "32783", "32784", "32785", "32786", "32787", "32788",
    "32789", "32790", "32791", "32792", "32793", "32794", "32795",
    "32796", "32797", "32798", "32799", "32800", "32801", "32802",
    "32803", "32804", "32805", "32806", "32807", "32808", "32809",
    "32810", "32811", "32812", "32813", "32814", "32815", "32816",
    "32817", "32818", "32819", "32820", "32821", "32822", "32823",
    "32824", "32825", "32826", "32827", "32828", "32829", "32830",
    "32831", "32832", "32833", "32834", "32835", "32836", "32837",
    "32838", "32839", "32840", "32841", "32842", "32843", "32844",
    "32845", "32846", "32847", "32848", "32849", "32850", "32851",
    "32852", "32853", "32854", "32855", "32856", "32857", "32858",
    "32859", "32860", "32861", "32862", "32863", "32864", "32865",
    "32866", "32867", "32868", "32869", "32870", "32871", "32872",
    "32873", "32874", "32875", "32876", "32877", "32878", "32879",
    "32880", "32881", "32882", "32883", "32884", "32885", "32886",
    "32887", "32888", "32889", "32890", "32891", "32892", "32893",
    "32894", "32895", "32896", "32897", "32898", "32899", "32900",
    "32901", "32902", "32903", "32904", "32905", "32906", "32907",
    "32908", "32909", "32910", "32911", "32912", "32913", "32914",
    "32915", "32916", "32917", "32918", "32919", "32920", "32921",
    "32922", "32923", "32924", "32925", "32926", "32927", "32928",
    "32929", "32930", "32931", "32932", "32933", "32934", "32935",
    "32936", "32937", "32938", "32939", "32940", "32941", "32942",
    "32943", "32944", "32945", "32946", "32947", "32948", "32949",
    "32950", "32951", "32952", "32953", "32954", "32955", "32956",
    "32957", "32958", "32959", "32960", "32961", "32962", "32963",
    "32964", "32965", "32966", "32967", "32968", "32969", "32970",
    "32971", "32972", "32973", "32974", "32975", "32976", "32977",
    "32978", "32979", "32980", "32981", "32982", "32983", "32984",
    "32985", "32986", "32987", "32988", "32989", "32990", "32991",
    "32992", "32993", "32994", "32995", "32996", "32997", "32998",
    "32999", "33001", "33002", "33003", "33004", "33005", "33006",
    "33007", "33008", "33009", "33010", "33011", "33012", "33013",
    "33014", "33015", "33016", "33017", "33018", "33019", "33020",
    "33021", "33022", "33023", "33024", "33025", "33026", "33027",
    "33028", "33029", "33030", "33031", "33032", "33033", "33034",
    "33035", "33036", "33037", "33038", "33039", "33040", "33041",
    "33042", "33043", "33044", "33045", "33046", "33047", "33048",
    "33049", "33050", "33051", "33052", "33053", "33054", "33055",
    "33056", "33057", "33058", "33059", "33060", "33061", "33062",
    "33063", "33064", "33065", "33066", "33067", "33068", "33069",
    "33070", "33071", "33072", "33073", "33074", "33075", "33076",
    "33077", "33078", "33079", "33080", "33081", "33082", "33083",
    "33084", "33085", "33086", "33087", "33088", "33089", "33090",
    "33091", "33092", "33093", "33094", "33095", "33096", "33097",
    "33098", "33099", "33100", "33101", "33102", "33103", "33104",
    "33105", "33106", "33107", "33108", "33109", "33110", "33111",
    "33112", "33113", "33114", "33115", "33116", "33117", "33118",
    "33119", "33120", "33121", "33122", "33123", "33124", "33125",
    "33126", "33127", "33128", "33129", "33130", "33131", "33132",
    "33133", "33134", "33135", "33136", "33137", "33138", "33139",
    "33140", "33141", "33142", "33143", "33144", "33145", "33146",
    "33147", "33148", "33149", "33150", "33151", "33152", "33153",
    "33154", "33155", "33156", "33157", "33158", "33159", "33160",
    "33161", "33162", "33163", "33164", "33165", "33166", "33167",
    "33168", "33169", "33170", "33171", "33172", "33173", "33174",
    "33175", "33176", "33177", "33178", "33179", "33180", "33181",
    "33182", "33183", "33184", "33185", "33186", "33187", "33188",
    "33189", "33190", "33191", "33192", "33193", "33194", "33195",
    "33196", "33197", "33198", "33199", "33200", "33201", "33202",
    "33203", "33204", "33205", "33206", "33207", "33208", "33209",
    "33210", "33211", "33212", "33213", "33214", "33215", "33216",
    "33217", "33218", "33219", "33220", "33221", "33222", "33223",
    "33224", "33225", "33226", "33227", "33228", "33229", "33230",
    "33231", "33232", "33233", "33234", "33235", "33236", "33237",
    "33238", "33239", "33240", "33241", "33242", "33243", "33244",
    "33245", "33246", "33247", "33248", "33249", "33250"
}


# Mostrar menú de selección de puertos
print("\n\n" + blueColour + "Elige el conjunto de puertos a escanear:" + endColour)
print("\n" + purpleColour + "1. 50 puertos más comunes" + endColour)
print(purpleColour + "2. 100 puertos más comunes" + endColour)
print(purpleColour + "3. 500 puertos más comunes" + endColour)
print(purpleColour + "4. 1000 puertos más comunes" + endColour)
print(purpleColour + "5. Escanear todos los puertos (1-65535)" + endColour)
print(purpleColour + "6. Especificar puertos personalizados" + endColour)

opcion = input("\n" + purpleColour + "Opción: " + endColour)

if opcion == "1":
    p = puertos_50
elif opcion == "2":
    p = puertos_100
elif opcion == "3":
    p = puertos_500
elif opcion == "4":
    p = puertos_1000
elif opcion == "5":
    p = set(map(str, range(1, 65536)))
elif opcion == "6":
    puertos_personalizados = input(purpleColour + "Especifica los puertos personalizados separados por comas: " + endColour)
    p = set(puertos_personalizados.split(','))
else:
    print(redColour + "Opción no válida." + endColour)
    sys.exit()

proxy = {"http": "http://" + ip + ":" + proxyport}
inicio = time.time()

for puerto in p:
    puerto = puerto.strip()
    try:
        r = requests.get("http://127.0.0.1:" + puerto, proxies=proxy)
        if r.status_code == 200:
            print("\n" + greenColour + "Puerto " + puerto + " abierto." + endColour)
    except requests.exceptions.Timeout:
        pass
    except requests.exceptions.ConnectionError:
        print(redColour + "Error: Target inalcanzable." + endColour)
    except KeyboardInterrupt:
        sys.exit()
    print("Puerto actual: " + puerto + " (" + str(round(time.time() - inicio, 2)) + " segundos)")
    sys.stdout.write("\033[F\033[K")
